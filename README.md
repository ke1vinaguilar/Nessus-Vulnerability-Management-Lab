<h1>Nessus Vulnerability Management Lab</h1>

 ### [YouTube Demonstration](https://youtu.be/7eJexJVCqJo)

<h2>Description</h2>
In this lab we're going to walk through how to create am Active Directory home lab Environment using Oracle Virtual Box. Configuring and running this lab will definitely help develop your understanding of how active directory and windows networking works, so I'd highly recommnend running through it a couple times, ask questions where stuff is unclear, and eventually try to build it on your own without watching. Please let me know if you have any questions!
<br />


<h2>Languages and Utilities Used</h2>

- <b>PowerShell</b> 
- <b>Oracle Virtual Box</b>

<h2>Environments Used </h2>

- <b>Windows 10 </b> (21H2)
- <b>Servers 2019</b>

<h2>Diagram</h2>
<p align="center">
<img src="https://i.imgur.com/Jtqs9WI.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
 </p>

<h2>Program walk-through:</h2>

<p align="center">
Download VMware Workstation Player: <br />
<a href="https://www.vmware.com/content/vmware/vmware-published-sites/us/products/workstation-player/workstation-player-evaluation.html.html ">VMware Workstation Player</a>
<br />
<br />
Download Windows 10 ISO File: <br />
<a href="https://www.microsoft.com/en-us/software-download/windows10">Windows 10 ISO</a>
<br />
<br />
Download Nessus Essentials Vulnerability Scanner: <br />
<a href="https://www.tenable.com/products/nessus/nessus-essentials ">Nessus Essentials Vulnerability Scanner</a>
<br />
<br />
Fill in the "Register for an Activation Code": <br />
<img src="https://i.imgur.com/C20ykYj.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Activation Code should be sent to your email: <br />
<img src="https://i.imgur.com/R47XOMj.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go to email and click on “Download Nessus”: <br />
<img src="https://i.imgur.com/hShHO6P.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “View Downloads”: <br />
<img src="https://i.imgur.com/Q69nT7F.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Select “Nessus 8.15.9” for “Version” and “Windows – x86_64” for “Platform” and click “Download”: <br />
<img src="https://i.imgur.com/x567Lqm.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Install Nessus with the InstallShield Wizard: <br />
<img src="https://i.imgur.com/I9DopVq.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Once done installing, will be redirected to this webpage: <br />
<img src="https://i.imgur.com/qNGnD4o.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Save the URL in a Notepad: <br />
<img src="https://i.imgur.com/cdrGqTJ.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Connect via SSL”: <br />
<img src="https://i.imgur.com/17jrMBy.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Advanced” and “Proceed to localhost (unsafe)”: <br />
<img src="https://i.imgur.com/ByQ5aCS.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Select “Nessus Essentials”: <br />
<img src="https://i.imgur.com/0YcvCU4.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Press “Skip”: <br />
<img src="https://i.imgur.com/ELlcswQ.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Input Activation Code that was received via email: <br />
<img src="https://i.imgur.com/mhiSjRu.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Create and username and password: <br />
<img src="https://i.imgur.com/mhiSjRu.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Complete the WMware Workstation Player Setup: <br />
<img src="https://i.imgur.com/M2jYhzL.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Create a new VM inside of Wmware Workstation Player: <br />
-Select “Player” <br />
<img src="https://i.imgur.com/nwQ2rMb.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “File” <br />
<img src="https://i.imgur.com/buIs0rc.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “New Virtual Machine…” <br />
<img src="https://i.imgur.com/k51vEMc.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<br />
<br />
Select “Browse”: <br />
<img src="https://i.imgur.com/1to5KUt.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Locate the “Windows10.iso” file and click on “Next”: <br />
<img src="https://i.imgur.com/ouO0gG6.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Set the “Maximum disk size (GB)” at “50”: <br />
<img src="https://i.imgur.com/juk4OYh.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Customize Hardware”: <br />
<img src="https://i.imgur.com/ukqnFhH.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Network Adapter” and select “Bridged: Connect directly to the physical network” and then click on “Close”: <br />
<img src="https://i.imgur.com/PXFV2Nt.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Select “Finish: <br />
<img src="https://i.imgur.com/Zs4cVDo.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Set up the Virtual Machine: <br />
-Press “Next” <br />
<img src="https://i.imgur.com/EMCWfJQ.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “I don’t have a product key” <br />
<img src="https://i.imgur.com/3ufuPRi.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “Windows 10 Pro” <br />
<img src="https://i.imgur.com/j1VpPty.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “Custom: Install Windows only (advanced)” <br />
<img src="https://i.imgur.com/iDFcf8z.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
- Click "Next" <br />
<img src="https://i.imgur.com/v3k32tM.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select “United States” <br />
-Select “I don’t have internet” <br />
-Name the PC “admin” <br />
<img src="https://i.imgur.com/TWK0ULM.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Set up password <br />
<img src="https://i.imgur.com/E2eFxh8.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Create 3 security questions and answers <br />
<img src="https://i.imgur.com/sWNsSVW.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select "No" for all "Privacy Settings" <br />
<img src="https://i.imgur.com/k5Z0WaV.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Select "No" for "Cortana Setup"
<br />
<br />
Disable the firewall on VM to be able to ping VM: <br />
-Go to VM and type "wf.msc" <br />
<img src="https://i.imgur.com/COPpHrS.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Windows Defender Firewall Properties” <br />
-Turn “Off” “Firewall state” for all 3 Profiles (Domain, Private, Public) <br />
<img src="https://i.imgur.com/glnUm0d.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<img src="https://i.imgur.com/Zoc3anb.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<img src="https://i.imgur.com/Vzd1vSd.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
*VM should now be able to communicate with the Personal Computer* <br />
<img src="https://i.imgur.com/CYHKcOu.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go to “Nessus Essentials” and create a New Scan: <br />
<img src="https://i.imgur.com/vOpBf4E.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Under “Vulnerabilities” select “Basic Network Scan”: <br />
<img src="https://i.imgur.com/R7IjINR.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
For “Name” type in “Windows 10 Single Host”: <br />
-For “Targets” Paste your VM’s IP address “192.168.68.157” <br />
-Click on “Save” <br />
<img src="https://i.imgur.com/1FBoU2G.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Launch”: <br />
<img src="https://i.imgur.com/nFVm4Yh.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
*Results* <br />
<img src="https://i.imgur.com/ViWBApc.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<img src="https://i.imgur.com/g4VYXrB.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<br />
<br />
Set up VM to accept authenticated scans: <br />
-Open up “Services.msc” <br />
<img src="https://i.imgur.com/ihNkE4i.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
“Enable” the “Remote Registry”: <br />
-Click “Apply” and then click “Start” <br />
<img src="https://i.imgur.com/MEd1mwZ.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go to “User Account Control Settings” and disable it: <br />
<img src="https://i.imgur.com/VvmvqzG.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Open up “Registry Editor” and add a key to allow the remote account to connect <br />
-Click on “HKEY_LOCAL_MACHINE” <br />
<img src="https://i.imgur.com/GQM2kAL.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
-Click on “Software” and then “Microsoft” <br />
-Click on “Window” and then “Current Version” <br />
-Click on “Policies” and then “System” <br />
<br />
<br />
Create a “DWORD (32-bit) Value” in “Systems” and name it “LocalAccountTokenFilterPolicy”: <br />
-Set the Value to “1” <br />
-Restart the VM <br />
<img src="https://i.imgur.com/mJ7yo9c.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<img src="https://i.imgur.com/ZOZM5MR.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go to “Nexus Essentials”: <br />
-Under “My Scans” check the box next to “Windows 10 Single Host” <br />
-Click on More” and select “Configure” <br />
<img src="https://i.imgur.com/t9UnHNP.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Credentials” and click on “Windows”: <br />
-Input the credentials to your VM and click on “Save” <br />
<img src="https://i.imgur.com/AzmMnxk.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
 Go back to my Scans and press on “Launch”: <br />
<img src="https://i.imgur.com/csqpKuK.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
*Results* <br />
<img src="https://i.imgur.com/UDm9Ffr.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<img src="https://i.imgur.com/i0Qfr5l.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<img src="https://i.imgur.com/bnEzAG9.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<br />
<br />
Install a deprecated version of Firefox in the VM using the following link: <br />
https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/ <br />
-Click on “Firefox Setup 3.6.12.exe” <br />
<img src="https://i.imgur.com/r0eKyyA.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Complete the Setup Wizard with default settings and Launch: <br />
<img src="https://i.imgur.com/6FQ1Z9X.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go back to “Nessus Essentials” and run another scan: <br />
*Results* <br />
<img src="https://i.imgur.com/RpW1No3.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<img src="https://i.imgur.com/dTgPjTr.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<img src="https://i.imgur.com/NIWR3nG.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
*Remediations* <br />
<img src="https://i.imgur.com/MNFsTDp.png" height="80%" width="80%" alt="Nessus Lab Steps"/> <br />
<br />
<br />
Remediate the VM by uninstalling FireFox and run update Windows as many times as possible: <br />
<br />
<br />
Go to “Programs and Features” by typing in “Run” in the search bar and typing in “appwiz.cpl”: <br />
<img src="https://i.imgur.com/p1jPoUP.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Mozilla Firefox (3.6.12)” and click on “Uninstall”: <br />
<img src="https://i.imgur.com/wJPHj5M.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go to “Windows Update” and click on “Check for updates”: <br />
<img src="https://i.imgur.com/ECklqd9.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Click on “Download and Install”: <br />
<img src="https://i.imgur.com/s79G0xV.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
Go back to “Nessus Essentials” and run another scan: <br />
*Results* <br />
<img src="https://i.imgur.com/UKuSndy.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<img src="https://i.imgur.com/CX7aAWY.png" height="80%" width="80%" alt="Nessus Lab Steps"/>
<br />
<br />
</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>

